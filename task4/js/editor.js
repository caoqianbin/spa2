var $editor=function(){var n=$('<div class="notepad-editor"><textarea spellcheck="false" auto-size="none"></textarea></div>'),l=n.find("textarea"),a={posHandler:null,contentHandler:null,wrap:!1},t=!1;function i(){var t=l.val().substr(0,l[0].selectionStart).split("\n");return t[t.length-1].length+1}function c(){return l.val().substr(0,l[0].selectionStart).split("\n").length}function e(t){t?(l.attr("wrap","soft"),l.css({"overflow-x":"hidden"})):(l.attr("wrap","off"),l.css({"overflow-x":"scroll"}))}return l.keyup(function(){a.posHandler(c(),i()),a.contentHandler(""!==l.val())}),l.keypress(function(){a.posHandler(c(),i())}),l.mousedown(function(){t=!0}),l.mouseup(function(){t=!1}),l.mousemove(function(){t&&a.posHandler(c(),i())}),l.click(function(){a.posHandler(c(),i())}),{show:function(t){$.extend(a,t),$("body").append(n),l.trigger("focus"),e(a.wrap)},resize:function(t){t?n.css({bottom:"21px"}):n.css({bottom:"0"})},focus:function(){l.focus()},getTotalLn:function(){return l.val().split("\n").length},getRow:c,getCol:i,setWrap:e,selectAll:function(){var t=l.val().length;l[0].selectionStart=0,l[0].selectionEnd=t,l.select()},insertDataTime:function(){var t=l.val(),n=t.substring(0,l[0].selectionStart),e=t.substring(l[0].selectionEnd,t.length);t=n+(new Date).toLocaleString()+e,l.val(t),l.focus(),a.posHandler(c(),i())},gotoLn:function(t){for(var n=0,e=l.val().split("\n"),o=0;o<t-1;o++)n+=e[o].length+1;l[0].selectionStart=n,l[0].selectionEnd=n,l.focus(),a.posHandler(c(),i())},bingSearch:function(){var t=l[0].selectionStart,n=l[0].selectionEnd;if(t===n)window.open("https://cn.bing.com/","_blank");else{var e=l.val().substring(t,n);window.open("https://cn.bing.com/search?q="+e,"_blank")}},search:function(t){var n=l.val(),e=t.content;t.capitalSense||(n=n.toLowerCase(),e=e.toLowerCase());var o,s=l[0].selectionEnd;o="down"===t.direction?n.indexOf(e,s):n.substr(0,l[0].selectionStart).lastIndexOf(e),-1!==o?(l[0].selectionStart=o,l[0].selectionEnd=o+e.length,a.posHandler(c(),i())):alert('找不到 "'+t.content+'"')},setFont:function(t){l.css({"font-family":t.family,"font-style":t.style,"font-size":t.size+"px"}),"斜体"!==t.style?"粗体"!==t.style?"粗偏斜体"!==t.style||l.css({"font-weight":"bold","font-style":"italic"}):l.css({"font-weight":"bold"}):l.css({"font-style":"italic"})}}}();